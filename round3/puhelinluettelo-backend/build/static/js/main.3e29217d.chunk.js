(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,function(e,n,t){e.exports=t(13)},,,,,,function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(3),o=t.n(c),u=(t(11),t(4)),l=t(1),i=function(e){var n=e.name,t=e.number,a=e.handler;return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,n," ",t," ",r.a.createElement("button",{onClick:a},"Remove")))},m=function(e){var n=e.parts,t=e.buttonHandler;return n.map(function(e){return r.a.createElement(i,Object.assign({key:e.id},e,{handler:function(){return t(e)}}))})},s=function(e){var n=e.handlers,t=e.values;return r.a.createElement("form",{onSubmit:n.handleSubmit},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"name"},"name: "),r.a.createElement("input",{name:"name",value:t.newName,onChange:n.handleNameChange}),r.a.createElement("label",{htmlFor:"number"},"number: "),r.a.createElement("input",{name:"number",value:t.newNum,onChange:n.handleNumChange})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"add")))},h=function(e){var n=e.handler,t=e.value;return r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"search"},"Filter based on name: "),r.a.createElement("input",{name:"search",value:t,onChange:n}))},f=(t(12),function(e){var n=e.type,t=e.message;return t&&n?r.a.createElement("div",{id:"notification",className:n},t):null}),d="/api/persons",b=function(e,n){return{method:e,body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}},E=function(){return fetch(d).then(function(e){return e.json()})},v=function(e){return fetch(d,b("POST",e)).then(function(e){if(201===e.status||400===e.status)return e.json().then(function(e){if(e.message)throw Error(e.message);return e});throw Error("Could not add person")})},p=function(e){return fetch("".concat(d,"/").concat(e.id),{method:"DELETE"}).then(function(n){if(!n.ok)throw Error("".concat(e.name," already removed"))})},g=function(e){return fetch("".concat(d,"/").concat(e.id),b("PUT",e)).then(function(n){switch(n.status){case 204:return e;case 400:return n.json().then(function(e){throw Error(e.message)});case 404:throw Error("".concat(e.name," already removed!"));default:throw Error("Could not remove person.")}}).then(function(e){return e})},w=function(){var e=Object(a.useState)([]),n=Object(l.a)(e,2),t=n[0],c=n[1],o=Object(a.useState)(""),i=Object(l.a)(o,2),d=i[0],b=i[1],w=Object(a.useState)(""),j=Object(l.a)(w,2),O=j[0],y=j[1],C=Object(a.useState)(""),N=Object(l.a)(C,2),S=N[0],k=N[1],F=Object(a.useState)({}),T=Object(l.a)(F,2),P=T[0],D=T[1],J=Object(a.useState)(),U=Object(l.a)(J,2),A=U[0],H=U[1],R=""===d?t:t.filter(function(e){return e.name.toUpperCase().includes(d.toUpperCase())}),x=function(e,n){D({type:e,message:n}),H(setTimeout(B,3e3))},B=function(){H(clearTimeout(A)),D({})},I=function(){y(""),k("")},L=function(e){var n,a=(n=e,t.find(function(e){return e.name===n.name}));if(a){var r=Object(u.a)({},a,{number:e.number});window.confirm("".concat(e.name," has already been added to the phonebook!\nWould you like to replace their number with the new one?"))&&g(r).then(function(e){I(),console.log("Making changes"),c(t.map(function(n){return n.id!==e.id?n:e})),q("Changed ".concat(e.name,"'s number to ").concat(e.number,"'!"))}).catch(function(e){return W(e,r)})}else v(e).then(function(e){I(),c(t.concat(e)),q("Added ".concat(e.name,"!"))}).catch(W)},M=function(e){c(t.filter(function(n){return n.id!==e.id}))};Object(a.useEffect)(function(){E().then(function(e){return c(e)}).catch(function(e){return alert("".concat(e.message,"\nPlease check your that the server is running."))})},[]);var W=function(e,n){e.message.includes("already removed")&&M(n),x("error",e.message)},q=function(e){x("success",e)};return r.a.createElement("div",null,r.a.createElement(f,P),r.a.createElement("h1",null,"Phonebook"),r.a.createElement(h,{value:d,handler:function(e){b(e.target.value)}}),r.a.createElement("h2",null,"Add new"),r.a.createElement(s,{handlers:{handleSubmit:function(e){e.preventDefault(),L({name:O,number:S})},handleNumChange:function(e){k(e.target.value)},handleNameChange:function(e){y(e.target.value)}},values:{newNum:S,newName:O}}),r.a.createElement("h2",null,"Numbers"),r.a.createElement(m,{parts:R,buttonHandler:function(e){window.confirm("Do you really want to remove ".concat(e.name))&&p(e).then(function(){M(e),q("Removed ".concat(e.name,"!"))}).catch(function(n){return W(n,e)})}}))};o.a.render(r.a.createElement(w,null),document.getElementById("root"))}],[[5,1,2]]]);
//# sourceMappingURL=main.3e29217d.chunk.js.map